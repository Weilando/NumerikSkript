\documentclass[12pt]{article}


\usepackage{algorithmic} %Für Pseudocode https://math-linux.com/latex-26/faq/latex-faq/article/how-to-write-algorithm-and-pseudocode-in-latex-usepackage-algorithm-usepackage-algorithmic
\usepackage{stmaryrd} %Für Widerspruchsblitz
\usepackage{amsmath} 
\usepackage{amssymb}
\usepackage{amsthm} %Für Theoreme und Beweise
\usepackage{graphicx} %Für Bilder

\newtheoremstyle{break}% name
  {}%         Space above, empty = `usual value'
  {}%         Space below
  {\itshape}% Body font
  {}%         Indent amount (empty = no indent, \parindent = para indent)
  {\bfseries}% Thm head font
  {.}%        Punctuation after thm head
  {\newline}% Space after thm head: \newline = linebreak
  {}%         Thm head spec

\theoremstyle{break}

\renewcommand{\thesection}{\Roman{section}}
\counterwithout{subsection}{section}
%\renewcommand{\thesubsection}{\arabic{subsection}}

%Definiere Satz, Definition,...
\newtheorem{theorem}{Satz}[subsection]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{korollar}[theorem]{Korollar}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{algorithm}[theorem]{Algorithmus}
\newtheorem{comment}[theorem]{Bemerkung}
\newtheorem*{comment*}{Bemerkung}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{example}[theorem]{Beispiel}
\newtheorem{nothing}[theorem]{}

\author{Prof. Schaedle}
\title{Numerik 1}

\begin{document}
\maketitle

\newpage

\section{Numerische Integration}

\input{Kapitel_1/Abschnitt_1} %Einführung
\input{Kapitel_1/Abschnitt_2} %Ordnung von Quadraturformeln
\input{Kapitel_1/Abschnitt_3} %Quadraturfehler
\input{Kapitel_1/Abschnitt_4} %Quadratur mit hoher Ordnung
\input{Kapitel_1/Abschnitt_5} %Orthogonalpolynome
\input{Kapitel_1/Abschnitt_6} %Ein adaptives Programm
\input{Kapitel_1/Abschnitt_7} %Gauß- und Loballo Quadraturformeln

\section{Interpolation und Approximation}

\begin{description}
  \item[Problemstellung A]
    Zu gegebenen $(x_0, y_0), ...,(x_n, y_n)$ berechne Polynom $p$ vom Grad $\leq n$ mit $$p(x_j) = y_j, \quad j=0,...,n$$
  
  \item[Problemstellung B]
    $f:[a,b] \rightarrow \mathbb{R}$ gegeben. Finde einfach auszuwertende Funktion $p: [a,b] \rightarrow \mathbb{R}$, etwa ein Polynom, stückweises Polynom, rationale Funktion, sodass $f-p$ klein ist.
    \begin{enumerate}
      \item[i)] $f(x)=p(x)$ für endlich viele vorgegebene Punkte $x$
      \item[ii)] $\int_a^b (f(x)-p(x))^2 dx$ soll minimal sein.
      \item[iii)] $\max_{x \in [a,b]} \vert f(x) -p(x) \vert$ soll minimal sein.
    \end{enumerate}
\end{description}

\subsection{Newtonsche Interpolationsformel}

\begin{example}
\begin{description}\item \end{description}
\begin{description}
  \item n=1: \\
    $(x_0, y_0),(x_1,y_1)$, $p \in \mathcal{P}_1$ das beide Punkte verbindet.\\
    $$p(x) = y_0 + (x-x_0) \frac{y_1-y_0}{x_1-x_0}$$
  \item n=2: \\
    $(x_0, y_0),(x_1,y_1),(x_2,y_2)$ \\
    $$p(x) = y_0 + (x-x_0) \frac{y_1-y_0}{x_1-x_0} + a(x-x_0)(x-x_1)$$
    Bestimme $a$ so, dass $p(x_2) = y_2$
    \begin{flalign*}
    y_2 &\overset{!}{=} y_0 + (x-x_0) \frac{y_1-y_0}{x_1-x_0} + a(x-x_0)(x-x_1)&\\
    a(x_2-x_0)(x_2-x_1) &= y_2 - y_0 - (x_2-x_1) \frac{y_1-y_0}{x_1-x_0} - y_1 + y_0 &\\
    \Rightarrow a &= \frac{1}{x_2-x_0} \left( \frac{y_2-y_1}{x_2-x_1} - \frac{y_1-y_0}{x_1-x_0} \right) 
     \end{flalign*}
\end{description}
\end{example}

\begin{definition}[dividierte Differenzen]
Für $(x_0,y_0), (x_1, y_1), ..., (x_n, y_n)$ mit paarweise verschiedenen Stützstellen $x_j$ definieren wir
\begin{flalign*}
y[x_j] &:= y_j \quad \left( = \delta^0 y[x_j] \right) &\\
\delta y[x_j, x_{j+1}] &:= \frac{y_{j+1} - y_j}{x_{j+1}-x_j} = \frac{\delta^0 y[x_{j+1}]-\delta^0 y[x_{j}]}{x_{j+1} - x_j} &\\
\delta ^2 y[x_j, x_{j+1}, x_{j+2}] &:= \frac{\delta y[x_{j+1}, x_{j+2}]-\delta y[x_{j}, x_{j+1}]}{x_{j+2} - x_j} &\\
\delta ^k y[x_j, x_{j+1},..., x_{j+k}] &:= \frac{1}{x_{j+k}-x_j} \left( \delta^{k-1} y[x_{j+1}, ..., x_{j+k}] - \delta^{k-1} y[x_j, ..., x_{j+k-1}] \right)
\end{flalign*}
\underline{Schema:}\\
\begin{tabular}{ccccc}
 
$x_0$ & $y_0$ & & &\\
 & & $\delta^1y[x_0, x_1]$ & &\\
$x_1$ & $y_1$ & &$\delta^2y[x_0, x_1, x_2]$ &\\
 & & $\delta^1y[x_1, x_2]$ & & $\delta^3y[x_0, x_1, x_2, x_3]$\\
$x_2$ & $y_2$ & & $\delta^2y[x_1, x_2, x_3]$ &\\
 & & $\delta^1y[x_2, x_3]$ & &\\
$x_3$ & $y_3$ & & &\\
 
\end{tabular}
\end{definition}

\begin{comment}
Falls die $x_i$ äquidistant, dh $x_i = x_0+ih$ so ist: \\
\begin{flalign*}
\delta y[x_i, x_{i+1}] &= \frac{y_{i+1} - y_i}{h} =: \frac{1}{h} \Delta y_i &\\
\delta ^2 y[x_i, x_{i+1}, x_{i+2}] &= \frac{\frac{1}{h} \Delta y_{i+1} - \frac{1}{h} \Delta y_{i}}{2h} = \frac{1}{2h^2} \Delta ^2 y_i &\\
\delta ^k y[x_i, ..., x_{i+k}] &= \frac{1}{k!h^k} \Delta^k y_i
\end{flalign*}
\end{comment}

\begin{theorem}[Newtonsche Interpolationsformel]
Zu paarweise verschiedenen reellen $x_i$, $i=0,..., n$ existiert ein eindeutiges Polynom $p \in \mathcal{P}_n$ durch die Punkte $(x_i, y_i)$, $i=0,...,n$ (d.h. $p(x_i) = y_i$ für $i=1,...,n$). Es lässt sich berechnen durch:
\begin{flalign*}
p(x) &= y[x_0] + (x-x_0) \delta y[x_0,x_1] + ... + (x-x_0)(x-x_1)...(x-x_{n-1}) \delta ^n y[x_0, ..., x_n] &\\
&= \sum_{i=0}^n \prod_{j=0}^{i-1} (x-x_j) \delta^iy[x_0,...,x_i] 
\end{flalign*}
\begin{proof}[Beweis](Induktion)
\begin{description}
  \item[IA] $n=1$ (und $n=2$) vgl. Beispiel (1.1)
  \item[IS] $n-1 \rightarrow n$\\
    $$p_0(x) = y[x_0] + (x-x_0) \delta y[x_1, x_0] + ... + (x-x_0)...(x-x_{n-2}) \delta ^{n-1}y[x_0,..., x_{n-1}]$$ 
    ist das eindeutige interpolierende Polynom mit 
    $$\text{deg}(p_0) \leq n-1$$
    zu $(x_0,y_0), (x_1, y_1), ..., (x_{n-1}, y_{n-1})$. \\
    Für den Ansatz
    $$p(x) = p_0(x) + a(x-x_0)(x-x_1)...(x-x_{n-1})$$
    ergibt die Forderung $p(x_n) = y_n$
    $$a = \frac{y_n-p_0(x_n)}{(x_n-x_0)(x_n-x_1)...(x_n-x_{n-1})}$$
    Da $a$ eindeutig ist, ist $p$ eindeutig.\\
    Es bleibt zu zeigen: $a = \delta^n y[x_0, ..., x_n]$\\
    Sei dazu ein Polynom $p_1(x)$, welches durch $(x_1, y_1), ..., (x_n, y_n)$ läuft, mit $\text{deg}(p_1) \leq n-1$. Nach Induktionsannahme gilt 
    \begin{flalign*}
    p_1(x) &= y[x_1] + (x-x_1) \delta^1y[x_1, x_2] + ... + (x-x_1)...(x-x_{n-1}) \delta ^{n-1}y[x_1, ..., x_n]&\\
    &=x^{n-1} \delta^{n-1}y[x_1, ..., x_n] + r
    \end{flalign*}
    mit $\text{deg}(r) \leq n-2$.\\
    Setze Polynom
    $$p(x) := \frac{x_n-x}{x_n-x_0} p_0(x) + \frac{x-x_0}{x_n-x_0}p_1(x)$$
    mit $\text{deg}(p) \leq n$ durch $(x_0, y_0), ..., (x_n, y_n)$. \\
    Das gilt, da: 
    \begin{flalign*}
    p(x_0) &= p_0(x_0) = y_0 &\\
    p(x_n) &= p_1(x_n) = y_n &\\
    \text{Für } i=1,...,n-1: &\\
    p(x_i) &= \frac{x_n-x_i}{x_n-x_0} \underbrace{p_0(x_i)}_{y_i} + \frac{x_i-x_0}{x_n-x_0} \underbrace{p_1(x_i)}_{y_i} = y_i
    \end{flalign*}
    Andererseits:
    $$p(x) = ax^n + r \quad \text{mit  deg}(r) \leq n-1$$
    Koeffizientenvergleich:
    \begin{align*}
    a &= - \frac{1}{x_n-x_0} \delta^{n-1}y[x_0, ..., x_{n-1}] + \frac{1}{x_n-x_0} \delta^{n-1}y[x_1, ..., x_{n}] &\\
    &= \delta^n y[x_0, ..., x_n]
    \end{align*}
\end{description}
\end{proof}
\end{theorem}

\begin{nothing}[Hornerschema]
Zur Auswertung des Interpolationspolynom $p$ an der Stelle $x$ verwendet man 
$$
p(x) = y[x_0] + (x-x_0) \left( \delta y[x_0, x_1] + (x-x_1) \left( \delta ^2 y[x_0, x_1, x_2] + (x-x_2) \left(  ... \left( \delta^n y[x_0, ..., x_n] \right) \right) \right) \right)
$$
\underline{Algorithmus:} \\
$s = \delta y^n[x_0, .., x_n]$ \\
for $k = n-1, ...,0$: \\
\space$s = \delta^k y[x_0, ..., x_k] + (x-x_k) s$
\end{nothing}

\begin{example}
\begin{tabular}{lllrrrrrr}
$i$ & $x_i$ & $y_i$ & & & & &\\
 &&&&&&&&\\
0 & -1 & 0 & & &&&&\\
& & & $\frac{1-0}{0-(-1)} = 1$ & &&&&\\
1 & 0 & 1 & & $\frac{0-1}{2-(-1)} = -\frac{1}{3}$ &&&&\\
& & & 0 & & $\frac{\frac{2}{3} - (-\frac{1}{3})}{3-(-1)} = \frac{1}{4}$ &&&\\
2 & 2 & 1 & & $\frac{2-0}{3-0} = \frac{2}{3}$ &&& $\frac{-\frac{2}{5} - \frac{1}{4}}{5-(-1)} = -\frac{13}{120}$&\\
& & & $\frac{3-1}{3-2} = 2$ & & $\frac{-\frac{4}{3} - \frac{2}{3}}{5-0} = -\frac{2}{5}$ &&&...\\
3 & 3 & 3 & & $\frac{-2-2}{5-2} = -\frac{4}{3}$ &&& ...&\\
& & & $\frac{-1-3}{5-3} = -2$ & & $\frac{\frac{9}{56} - (-\frac{4}{3})}{17-2} = \frac{251}{2520}$ &&&\\
4 & 5 & -1 & & $\frac{\frac{1}{4} -(-2)}{17-3} = \frac{9}{56}$ &&&& \\
& & & $\frac{2-(-1)}{17-5} = \frac{1}{4}$ &&&&& \\
5 & 17 & 2 & & &&&& \\
\end{tabular} \\
Das Interpolationspolynom ist also
$$p(x) = 0 + (x+1) *1 - \frac{1}{3}(x+1)(x) + \frac{1}{4}(x+1)x(x-2)+(x+1)x(x-2)(x-3)\left(-\frac{13}{120}\right)$$
bzw. nach Hornerschema
\begin{align*}
p(x) &= 0+(x+1)\left(1+ x\left(-\frac{1}{3} + (x-2)\left(\frac{1}{4} + (x-3)\left(-\frac{13}{120}\right)\right)\right)\right) &\\
\end{align*}
Werte $p(x)$ an der Stelle 1 aus:
\begin{align*}
-\frac{13}{120}* (-2) &= \frac{26}{120} &\\
\left( \frac{1}{4} + \frac{26}{120} \right)(-1) &= -\frac{56}{120} = -\frac{7}{15} &\\
\left( -\frac{7}{15} - \frac{1}{3}\right) 1 &= -\frac{12}{15} = -\frac{4}{5} &\\
\left(-\frac{4}{5} + 1\right)2 &= \frac{2}{5} = p(1) &\\
\end{align*}
\end{example}

\subsection{Fehler bei der Polynominterpolation}

\underline{Problem:} $f: \thinspace [a,b] \rightarrow \mathbb{R}$ werde interpoliert in Stützstellen $x_0, ..., x_n \in [a,b]$ durch $p \in \mathcal{P}_n$ mit $p(x_i) = f(x_i)$ für $i=0,...,n$ \\
Wie groß ist der Fehler $f(x)-p(x)$?

\begin{theorem}
Sei $f: [a,b] \rightarrow \mathbb{R}$ (n+1)-mal stetig differenzierbar, $p \in \mathcal{P}_n$ mit $p(x_i) = f(x_i)$ ($i=0,...,n$) das Interpolationspolynom zu paarweise verschiedenen Stützstellen $x_i \in [a,b]$ ($i=0,..., n$). Dann gilt: \\
$\forall x \in [a,b] \exists \xi = \xi(x) \in (a,b): f(x)-p(x) = \prod_{i=0}^n (x-x_i) \frac{f^{(n+1)}(\xi)}{(n+1)!}$
\begin{proof}[Beweis]
Siehe (9.4)
\end{proof}
\end{theorem}

\begin{example}[Berechnung von Logarithmentafeln: Briggs, 17. Jhd]
$f(x) = log_{10}(x), \quad x \in [55, 58]$\\
Wähle Stützstellen:\\
$x_0 = 55, \quad x_1 = 56, \quad x_2 = 57, \quad x_3=58$ \\
Berechne Näherung an $log_{10}(56.5)$, falls $log_{10}(55), log_{10}(56), log_{10}(57) \text{ und } log_{10}(58)$ bereits bekannt sind.\\
$\rightsquigarrow$ Interpolationspolynom $p$:
\begin{flalign*}
log_{10}(65.5) &= 1.752048448 &\\
p(56.5) &= 1.75204845 &\\
f'(x) &= \frac{1}{ln(10)x} &\\
f''(x) &= -\frac{1}{ln(10)x^2} &\\
f^{(3)}(x) &= \frac{2}{ln(10)x^3} &\\
f^{(4)}(x) &= -\frac{6}{ln(10)x^4} &\\
\text{Für } x\in[55, 58]: &\\
\vert f^{(4)}(x)\vert &\leq \frac{6}{55^4 ln(10)}
\Rightarrow &\\
\vert log_{10}(56.5) - p(56.5) \vert &\leq 1.5 * 0.5 * 0.5 * 1.5 * \frac{6}{55^4ln(10) \frac{1}{4!}} &\\
&\approx 6.7 * 10^{-9}
\end{flalign*}
\end{example}

Für den Beweis von (9.1) wird folgendes Lemma benötigt:

\begin{lemma}
Sei $f \in C^n([a,b])$ und sei für paarweise verschiedene $x_i \in [a,b]$ ($i=0,...,n$) $y_i := f(x_i)$. Dann existiert $\xi \in (\min_i(x_i), \max_i(x_i))$, sodass 
$$\delta^ny[x_0,..., x_n] = \frac{f^{(n)}(\xi)}{n!}\quad (x_0 < x_1 < ... < x_n)$$
\begin{proof}[Beweis]
Sei $p$ ein Interpolationspolynom zu $(x_i, y_i)_{i=0}^n$. Setzt man $d:= p-f$, so gilt $d(x_i) = 0$ für $i=0,...,n$.\\
n-maliges anwenden des Mittelwertsatzes liefert paarweise verschiedene $\xi_i$, $(i=0, ...,n-1)$ mit $d'(\xi_i) = 0$ für $\xi_i \in (\min_j(x_j), \max_j(x_j))$. \\
Dasselbe Argument angewandt auf $d'$ liefert $\eta_0,..., \eta_{n-2}$ mit $d''(\eta_i) = 0$ für $i=0,..., n-2$.\\
Wiederhole dies bis:\\
Es existiert $\rho_0$ mit $d^{(n)}(\rho_0) = 0$\\
$\Rightarrow f^{(n)}(\rho_0) = p^{(n)}(\rho_0) = n! \delta^ny[x_0,..., x_n],$\\
da $\delta^ny[x_0, ..., x_n]$ der Koeffizient von $x^n$ in $p$ ist.
\end{proof}
\end{lemma}

\begin{comment*}
Für $n=1$ ist Lemma (9.3) der Mittelwertsatz (oder Satz von Rolle) aus Ana I:
$$ \exists \xi: \frac{f(x_1)-f(x_2)}{x_1-x_2} = f'(\xi)$$
\end{comment*}

\begin{nothing}[Beweis von (9.1)]
Sei $\bar{x} \in [a,b]$ beliebig.
\begin{description}
  \item[1. Fall] $\bar{x} = x_i$ für ein $i \in \{0,...,n\}$, so ist wegen $p(x_i) - f(x_i) = 0$ nichts zu zeigen.
  
  \item[2. Fall] $\bar{x} \neq x_i$ für alle $i \in \{0,...,n\}$. Sei $\bar{p}$ das Interpolationspolynom mit $\text{deg}(\bar{p}) \leq n+1$ zu $(x_i, f(x_i))_{i=0}^n$ und $(\bar{x}, f(\bar{x}))$. Die Newton'sche Interpolationsformel liefert dann
  \begin{align*}
  \bar{p}(x) &= p(x) + \prod_{i=0}^n(x-x_i)\delta^{n+1}y[x_0,...,x_n, \bar{x}] &\\
  &\underset{(9.3)}{=} p(x) + \prod_{i=0}^n(x-x_i) \frac{f^{(n+1)}(\xi)}{(n+1)!}
  \end{align*}
  Für $x = \bar{x}$ gilt $\bar{p}(\bar{x}) = f(\bar{x})$. Damit ist Satz (9.1) für $x\in[a,b]$ gezeigt.\qed
\end{description}
\end{nothing}

\underline{Fragen:}
\begin{itemize}
  \item Für welche Wahl der Stützstellen $x_i$ ($i=0,...,n$, n fest) ist 
    $$\max_{x\in[a,b]} \vert \prod_{i=0}^n(x-x_i)\vert$$
    minimal? (Siehe Abschnitt 10)
  \item Wie wirken sich Fehler in den Funktionsauswertungen (etwa Messfehler oder Rechenfehler) auf das Interpolationspolynom aus?
\end{itemize}

\begin{theorem}[Lagrange Interpolationsformel]
Das Interpolationspolynom $p$ zu $(x_i, y_i)_{i=0}^n$ ist gegeben durch 
$$p(x) = \sum_{i=0}^n y_il_i(x)$$
mit 
$$l_i(x) = \frac{\prod_{j=0,\thinspace j\neq i}^n (x-x_j) }{\prod_{j=0,\thinspace j\neq i}^n ( x_i-x_j)}$$
\begin{proof}[Beweis]
$\text{deg}(l_i) = n$, $l_i(x_j) = \left\{
\begin{array}{ll}
1 & \textrm{für } j=i \\
0 & \, \textrm{sonst} \\
\end{array}
\right.$ \\
$\Rightarrow p(x_j) = \sum_{i=0}^n y_il_i(x_j) = y_j$
\end{proof}
\end{theorem}

\begin{comment*}
Lagranges und Newtons Interpolationsformeln liefern beide das gleiche Polynom nur in unterschiedlichen Darstellungen.
\end{comment*}

\begin{definition}
$$\Lambda_n := \max_{x\in[a,b]} \sum_{i=0}^n\vert l_i(x) \vert$$
heißt die \textbf{Lebesgue Konstante} zu den Stützstellen $x_i$, $i=0,...,n$ auf dem Intervall $[a,b]$.
\end{definition}

Damit gilt:

\begin{theorem}
Sei $p$ das Interpolationspolynom (vom Grad $\leq n$) zu $(x_i, y_i)_{i=0}^n$ und $\tilde{p}$ das Interpolationspolynom zu $(x_i, \tilde{y}_i)_{i=0}^n$, so gilt:
$$ \max_{x \in [a,b]} \vert p(x) - \tilde{p}(x) \vert \leq \Lambda_n \max_{i=0,...,n}\vert y_i - \tilde{y}_i \vert $$
\begin{proof}[Beweis]
klar
\end{proof}
\end{theorem}

\begin{example}
\begin{description}\item \end{description}
\begin{itemize}
  \item Für äquidistante Stützstellen $x_i = a + i\frac{b-a}{n}$ ($i=0,...,n$) ist 
    \begin{align*}
    \Lambda_{10} &\approx 40 &\\
    \Lambda_{20} &\approx 3*10^4 &\\
    \Lambda_{40} &\approx 10^{10} &\\
    \Lambda_{n} &\approx \frac{2^n}{ln(n)*e*n} \quad \text{für } n \rightarrow \infty&\\
    \end{align*}
    $\Rightarrow$ Vorsicht bei Polynominterpolation mit vielen äquidistanten Stützstellen! \\
    In $\S$10 werden wir Stützstellen kennenlernen mit $\Lambda_n \leq 4$ für $n \leq 100$.
\end{itemize}
\end{example}

\end{document}